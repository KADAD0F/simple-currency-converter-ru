# Currency Converter ru

## Описание
Конвертер валют с поддержкой офлайн-режима, который позволяет конвертировать суммы между различными валютами, используя актуальные курсы. Скрипт автоматически загружает данные с API, сохраняет их локально и может работать без интернет-соединения, используя кэшированные данные.

## Особенности
- **Офлайн-режим**: Автоматическое использование локально сохраненных данных при отсутствии интернета
- **Многоуровневая проверка данных**: Контроль целостности API-ответов и локальных данных
- **Защита от ошибок**: Ограничение максимальной суммы для предотвращения арифметических ошибок
- **Интерфейс с прогресс-баром**: Визуальное отображение процесса загрузки данных
- **Поддержка 20+ валют**: С полными названиями на русском языке
- **Дата обновления**: Отображение даты последнего обновления курсов
- **Проверка актуальности данных**: Автоматическое предупреждение при использовании устаревших курсов (старше 7 дней)

## Требования
- Python 3.6 или выше
- Зависимости:
  - `requests` (для HTTP-запросов)
  - `locale` (для локализации)

## Установка
1. Установите зависимости:
```bash
pip install requests
```
2. Сохраните скрипт как `currency_converter.py`

## Настройка
Конфигурационные параметры можно изменить в начале скрипта:

```python
# Путь к файлу локальной базы данных
DB_FILE = "currency_rates.json"

# Список API-источников для получения данных
API_URLS = [
    "https://api.exchangerate-api.com/v4/latest/USD",
    "https://api.exchangerate-api.com/v4/latest/EUR"
]

# Максимальная сумма для конвертации
MAX_AMOUNT = 1_000_000_000

# Словарь с названиями валют
CURRENCY_NAMES = {
    "USD": "Доллар США",
    "EUR": "Евро",
    # ... остальные валюты
}
```

## Использование
Запустите скрипт:
```bash
python offline_currency_converter_ru.py
```

После запуска:
1. Скрипт проверит интернет-соединение и обновит данные при наличии
2. Отобразит статус данных (актуальные/устаревшие/отсутствуют)
3. Покажет список доступных валют с номерами
4. Запросит исходную валюту, сумму и целевую валюту
5. Выполнит конвертацию и покажет результат

## Структура кода

### Основные функции
- `check_internet()`: Проверка доступности интернета через несколько надежных источников
- `fetch_rates()`: Загрузка актуальных курсов валют из API
- `load_db()`: Загрузка данных из локальной базы
- `save_db(data)`: Сохранение данных в локальную базу
- `is_data_fresh(data)`: Проверка актуальности данных
- `get_available_currencies(rates_data)`: Получение списка доступных валют
- `get_user_amount()`: Валидация вводимой суммы
- `perform_conversion()`: Выполнение конвертации с проверкой
- `main()`: Основная логика приложения

### Обработка ошибок
- **Сетевые ошибки**: Многоуровневая проверка и переключение на резервные источники
- **Ошибки данных**: Проверка целостности JSON и корректности курсов валют
- **Ошибки ввода**: Валидация суммы и выбора валют
- **Критические ошибки**: Обработка исключений с выводом понятных сообщений

## Пример работы
```
Проверка базы данных..
Обновление данных.. [██████████████████████████████]

✓ Данные успешно обновлены, курс валют на 08.07.2025.

Дарова, ты в конвертере валют!
Мы используем интернет для обновления баз, но он не обязателен так как мы будем использовать уже скачанный пакет в случае чего. Чтобы перевести валюту, выбери исходную валюту:

Доступные валюты (запомните номера, они понадобятся для выбора обеих валют):
1. Доллар США (USD)
2. Евро (EUR)
3. Рубль (RUB)
...

-> Выберите исходную валюту (номер из списка выше): 1

Понял, валюта "Доллар США", какое значение?
-> 100

-> Выберите целевую валюту (номер из списка выше): 3

==================================================
Операция конвертации:
100.00 Доллар США (USD)
→ 8,520.00 Рубль (RUB)
Курс на 08.07.2025
==================================================

Отлично! Итог рассчитан.

Хотите выполнить еще одну конвертацию? (да/нет): 
```

## Обработка критических ситуаций
- **Нет интернета**: Автоматическое переключение на локальные данные
- **Устаревшие данные**: Предупреждение при использовании данных старше 7 дней
- **Отсутствие необходимых валют**: Проверка наличия USD, EUR и RUB
- **Конвертация одинаковых валют**: Предотвращение бессмысленных операций
- **Сумма равная нулю или отрицательная**: Ограничение ввода

## Информация о данных
- **Источники данных**: ExchangeRate-API.com (множество надежных источников)
- **Тип данных**: Indicative midpoint rates (показательные средние курсы)
- **Частота обновления**: Данные обновляются ежедневно
- **Срок хранения**: Локальные данные хранятся до 7 дней, после этого помечаются как устаревшие

## Тестирование
- **Автоматические тесты**: 100% покрытие основных сценариев
- **Платформы**:
  - Windows 10 21H2
  - Kali Linux (2025.2)
  - Termux (Android 13)
- **Проверенные сценарии**:
  - Работа с разными валютами
  - Обработка сетевых ошибок
  - Конвертация граничных значений
  - Отображение кириллических символов

## Версия и лицензия
- **Версия**: 1.0
- **Дата релиза**: 25.08.2025
- **Лицензия**: Нет

## Примечание
Этот скрипт использует данные от ExchangeRate-API.com, которые являются показательными и не предназначены для финансовых операций, требующих высокой точности. Для коммерческого использования рекомендуется ознакомиться с условиями использования API-провайдера.
